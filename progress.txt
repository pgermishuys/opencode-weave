## Progress Log

### 2026-02-21 — todowrite-sidebar-integration plan (Tapestry)

Completed all 6 tasks in the `todowrite-sidebar-integration` plan:

1. **Tapestry prompt** (`src/agents/tapestry/default.ts`): Added `<SidebarTodos>` section with concrete instructions for when/how to write sidebar todos during plan execution (STARTING, COMPLETING, BLOCKED, COMPLETES states). Max 35 chars, max 5 todos, `in_progress` for current task only.

2. **Loom prompt** (`src/agents/loom/default.ts`): Added `<SidebarTodos>` section with delegation-aware todowrite instructions (PLANNING, DELEGATING, QUICK TASKS states). Agent-prefixed delegations, clear completion signaling.

3. **start-work-hook** (`src/hooks/start-work-hook.ts`): Enhanced `buildFreshContext()` and `buildResumeContext()` to inject `**SIDEBAR TODOS**` bootstrapping instructions. Resume context includes remaining task count.

4. **context-window-monitor** (`src/hooks/context-window-monitor.ts`): Warning and recovery messages now include `todowrite` instructions to surface context alerts in the sidebar with `in_progress` status for visual prominence.

5. **work-continuation** (`src/hooks/work-continuation.ts`): Continuation prompt now instructs the agent to restore sidebar state via `todowrite` (summary + next task + 2-3 upcoming) before resuming work.

6. **Tests updated**: Added "SIDEBAR TODOS" assertions to start-work-hook tests, "todowrite" assertions to context-window-monitor and work-continuation tests.

All 404 tests pass. Build succeeds.

**Next**: This plan is complete. No follow-on work identified.

---

### 2026-02-21 — warp-agent plan (Tapestry)

Completed all 15 tasks in the `.weave/plans/warp-agent.md` plan — added **Warp** as the 8th built-in agent (security & specification compliance auditor).

**New files:**
- `src/agents/warp/default.ts` — full system prompt (Role, Triage, SecurityReview, SpecificationCompliance, Verdict, SkepticalBias, Constraints)
- `src/agents/warp/index.ts` — factory function following Weft pattern
- `src/agents/warp/index.test.ts` — 15 unit tests

**Modified source files:**
- `src/agents/types.ts` — added `"warp"` to `WeaveAgentName` union
- `src/agents/builtin-agents.ts` — imported and registered `createWarpAgent`
- `src/agents/model-resolution.ts` — Sonnet-class fallback chain for warp
- `src/agents/dynamic-prompt-builder.ts` — added `buildWarpSection` function
- `src/agents/loom/default.ts` — Warp added to Delegation and ReviewWorkflow sections
- `src/hooks/verification-reminder.ts` — Warp reference for security-relevant changes
- `src/shared/agent-display-names.ts` — added `warp: "warp"` entry

**Updated tests:** builtin-agents.test.ts, dynamic-prompt-builder.test.ts, agent-display-names.test.ts, workflow.test.ts, integration.test.ts (all counts updated from 7→8 agents).

**Updated docs:** README.md, docs/architecture.md, docs/agent-interactions.md, docs/configuration.md.

Key design decisions:
- Warp is **read-only** (write, edit, task, call_weave_agent all denied)
- **Skeptical bias** — REJECT by default when security patterns detected
- **Sonnet-class model** (needs reasoning power for spec analysis)
- **Self-triaging** — fast-exits with [APPROVE] if no security-relevant changes detected
- Three-layer spec knowledge: built-in LLM → webfetch RFC verification → optional `.weave/specs.json`

All 427 tests pass. Build and typecheck clean (zero warnings).

**Next**: Warp is fully integrated. Future work could add `.weave/specs.json` support to the config schema if project-level spec registries are needed.

---

### 2026-02-21 — Release v0.3.1

Released **v0.3.1** to GitHub.

- Optimized agent model assignments for role-appropriate reasoning:
  - **Weft** (reviewer): haiku-4.5 → sonnet-4.6 — better code review quality
  - **Warp** (security auditor): sonnet-4.6 → opus-4.6 — deeper security reasoning
  - **Spindle** (external researcher): sonnet-4.6 → haiku-4.5 — cost efficiency for fetch-and-format tasks
- All 427 tests passing, build clean

**Previous release**: v0.3.0 → **New release**: v0.3.1

---

### 2026-02-21 — Release v0.3.0

Released **v0.3.0** to GitHub: https://github.com/pgermishuys/weave/releases/tag/v0.3.0

- Bumped `package.json` version from `0.2.0` → `0.3.0`
- Created git tag `v0.3.0` and pushed to remote
- Created GitHub release with full changelog highlighting the Warp agent addition
- All 427 tests passing, build clean

**Previous release**: v0.2.0 → **New release**: v0.3.0
